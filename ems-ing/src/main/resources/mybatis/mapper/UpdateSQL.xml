<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="sample.mybatis">
    <insert id="updateStateComponent">
        insert into tag_set_mapper (tag_list_id, tag_set_id)
        SELECT tag_list_id,
               4 AS `tag_set_id`
        FROM tag_list tl
        WHERE tl.`type` IN (
                            "COMP_Power",
                            "COMP_SystemPre",
                            "COMP_AutoStop",
                            "COMP_StartPre",
                            "COMP_StopPre",
                            "COMP_ActTripCode",
                            "COMP_ActWarCode",
                            "COMP_Trip",
                            "COMP_Warning",
                            "COMP_LoadFactor") on duplicate key
        UPDATE
            tag_list_id =
        VALUES (`tag_list_id`),
            tag_set_id =
        VALUES (`tag_set_id`);

    </insert>
    <insert id="updateMainPageComponent">
        insert into tag_set_mapper (tag_list_id, tag_set_id)
        SELECT tag_list_id,
               5 AS `tag_set_id`
        FROM tag_list tl
        WHERE tl.`type` IN (
                            "COMP_SystemPre") on duplicate key
        UPDATE
            tag_list_id =
        VALUES (`tag_list_id`),
            tag_set_id =
        VALUES (`tag_set_id`);

    </insert>
    <insert id="updateDetailPageComponent">
        insert into tag_set_mapper (tag_list_id, tag_set_id)
        SELECT tag_list_id,
               6 AS `tag_set_id`
        FROM tag_list tl
        WHERE tl.`type` NOT IN (
                            "COMP_Power",
                            "COMP_SystemPre",
                            "COMP_AutoStop",
                            "COMP_StartPre",
                            "COMP_StopPre",
                            "COMP_ActTripCode",
                            "COMP_ActWarCode",
                            "COMP_Trip",
                            "COMP_Warning",
                            "COMP_LoadFactor") on duplicate key
        UPDATE
            tag_list_id =
        VALUES (`tag_list_id`),
            tag_set_id =
        VALUES (`tag_set_id`);

    </insert>

    <insert id="updateImportantComponent">
        insert into tag_set_mapper (tag_list_id, tag_set_id)
        SELECT tag_list_id,
               7 AS `tag_set_id`
        FROM tag_list tl
        WHERE tl.`type` NOT IN (
                        "COMP_SystemPre") on duplicate key
        UPDATE
            tag_list_id =
        VALUES (`tag_list_id`),
            tag_set_id =
        VALUES (`tag_set_id`);

    </insert>
    <insert id="updateGroupPageComponent">
        insert into tag_set_mapper (tag_list_id, tag_set_id)
        SELECT tag_list_id,
               8 AS `tag_set_id`
        FROM tag_list tl
        WHERE tl.`type` NOT IN (
                                "COMP_Power",
                                "COMP_SystemPre") on duplicate key
        UPDATE
            tag_list_id =
        VALUES (`tag_list_id`),
            tag_set_id =
        VALUES (`tag_set_id`);

    </insert>
    <delete id="deleteTagSetMapperDuplicate">
        DELETE
        FROM tag_set_mapper
        WHERE tag_set_mapper_id IN
              (
                  SELECT tag_set_mapper_id FROM (SELECT tag_set_mapper_id FROM tag_set_mapper GROUP BY tag_list_id, tag_set_id HAVING count(*) > 1) temp_table
              );
    </delete>
    <delete id="deleteSroucesHourWithDay">
        DELETE
        FROM `tagdata`.sources_hour_with_day
    </delete>
    <insert id="insertSroucesHourWithDay">
        insert into sources_hour_with_day (`logvalue`)
        values (0),
               (1),
               (2),
               (3),
               (4),
               (5),
               (6),
               (7),
               (8),
               (9),
               (10),
               (11),
               (12),
               (13),
               (14),
               (15),
               (16),
               (17),
               (18),
               (19),
               (20),
               (21),
               (22),
               (23),
               (24),
               (25),
               (26),
               (27),
               (28),
               (29),
               (30),
               (31),
               (32) on duplicate key
        UPDATE
            `logvalue` =
        VALUES (`logvalue`);
    </insert>
</mapper>